(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     33290,        872]
NotebookOptionsPosition[     28667,        781]
NotebookOutlinePosition[     29654,        810]
CellTagsIndexPosition[     29611,        807]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
https://mathematica.stackexchange.com/questions/137892/reduce-a-set-\
expression-in-mahematica/137917#137917
https://mathematica.stackexchange.com/questions/18393/what-are-the-most-\
common-pitfalls-awaiting-new-users/25616#25616
https://reference.wolfram.com/language/guide/LogicAndBooleanAlgebra.html
https://mathematica.stackexchange.com/questions/101819/how-can-i-define-\
operators-that-implement-the-algebra-of-sets
https://reference.wolfram.com/language/tutorial/KeyboardShortcutListing.html
\
\>", "Text",
 CellChangeTimes->{{3.8426285040330844`*^9, 3.842628538407049*^9}, {
  3.842675297667774*^9, 
  3.842675300240515*^9}},ExpressionUUID->"e31d5a77-b1ca-47bb-8f44-\
a09bbd99dc93"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BoolTable", "[", "f_Function", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"x", ",", "y"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TableForm", "[", 
        RowBox[{
         RowBox[{"BooleanTable", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", 
             RowBox[{"f", "[", 
              RowBox[{"x", ",", "y"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ",", 
         RowBox[{"TableHeadings", "->", 
          RowBox[{"{", 
           RowBox[{"None", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", 
              RowBox[{"f", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}], "}"}]}]}], "]"}], 
       ",", 
       RowBox[{"BooleanConvert", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"x", ",", "y"}], "]"}], ",", "NOR"}], "]"}], ",", 
       RowBox[{"BooleanMinimize", "[", 
        RowBox[{"f", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "]"}]}], "}"}], "]"}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BoolTable", "[", "f_", "]"}], ":=", " ", 
   RowBox[{"BoolTable", "[", 
    RowBox[{"Function", "[", "f", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"BoolTable", "[", 
   RowBox[{"f_Function", ",", "v_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"p", ",", "q", ",", "r"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Column", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TableForm", "[", 
        RowBox[{
         RowBox[{"BooleanTable", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"f", "[", "v", "]"}]}], "}"}], "]"}], ",", "v"}], "]"}],
          ",", 
         RowBox[{"TableHeadings", "->", 
          RowBox[{"{", 
           RowBox[{"None", ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{"{", 
              RowBox[{"v", ",", 
               RowBox[{"f", "[", "v", "]"}]}], "}"}], "]"}]}], "}"}]}]}], 
        "]"}], ",", 
       RowBox[{"BooleanConvert", "[", 
        RowBox[{
         RowBox[{"f", "[", "v", "]"}], ",", "NOR"}], "]"}], ",", 
       RowBox[{"BooleanMinimize", "[", 
        RowBox[{"f", "[", "v", "]"}], "]"}]}], "}"}], "]"}]}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoolTable", "[", 
   RowBox[{"f_", ",", "v_"}], "]"}], ":=", 
  RowBox[{"BoolTable", "[", 
   RowBox[{
    RowBox[{"Function", "[", "f", "]"}], ",", "v"}], "]"}]}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.8403264852603464`*^9, 3.840326485268345*^9}, {
   3.8405158241783676`*^9, 3.840515826282175*^9}, 3.840515870342698*^9, {
   3.8406656597482157`*^9, 3.84066566004946*^9}, {3.840665754626793*^9, 
   3.8406658531997485`*^9}, {3.840665980357299*^9, 3.8406659851562605`*^9}, 
   3.840666082731449*^9, 3.8406661717553787`*^9, 3.8418587012796926`*^9, {
   3.8425554908312654`*^9, 3.8425554923644524`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"394424fb-3331-447f-8d1b-0efbebb0e9c9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Approximate2", "[", 
   RowBox[{"r_", ",", 
    RowBox[{"nConvergents_", ":", "8"}], ",", 
    RowBox[{"precision_", ":", "10"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c", "=", 
      RowBox[{"Convergents", "[", 
       RowBox[{"ContinuedFraction", "[", 
        RowBox[{"r", ",", "nConvergents"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"TableForm", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"c", ",", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"r", "-", "c"}], ",", "precision"}], "]"}]}], "}"}], "]"}],
       ",", 
      RowBox[{"TableHeadings", "->", 
       RowBox[{"{", 
        RowBox[{"None", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<approximation of \>\"", ",", "r"}], "}"}], "]"}], 
           ",", "\"\<error\>\""}], "}"}]}], "}"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.8406579868756204`*^9, 3.840658023414708*^9}, 
   3.8406642557679667`*^9, {3.840672662362583*^9, 3.840672663888462*^9}, 
   3.8418587066413975`*^9, 3.8425549174764724`*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"6900b41d-071e-4396-98a9-de48135572ae"],

Cell[BoxData[
 RowBox[{"ListVariables", ":=", 
  RowBox[{"Names", "[", "\"\<Global`*\>\"", "]"}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.8406642832587333`*^9, 3.8406643222186375`*^9}, {
   3.840672644881306*^9, 3.8406726553945417`*^9}, 3.841858706641899*^9, 
   3.8425549426659937`*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"5a3c3127-7de1-47eb-a4af-6817984596f0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MakeBoxes", "[", 
    RowBox[{"EmptySet", ",", "form_"}], "]"}], "^=", 
   RowBox[{"TemplateBox", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\"\<EmptySet\>\"", ",", 
     RowBox[{"DisplayFunction", "->", 
      RowBox[{"(", 
       RowBox[{"\"\<\[EmptySet]\>\"", "&"}], ")"}]}], ",", 
     RowBox[{"InterpretationFunction", "->", 
      RowBox[{"(", 
       RowBox[{"\"\<EmptySet\>\"", "&"}], ")"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeBoxes", "[", 
     RowBox[{"UniversalSet", ",", "form_"}], "]"}], "^=", 
    RowBox[{"TemplateBox", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\"\<UniversalSet\>\"", ",", 
      RowBox[{"DisplayFunction", "->", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"StyleBox", "[", 
          RowBox[{"\"\<\[DoubleStruckCapitalU]\>\"", ",", 
           RowBox[{"FontFamily", "->", "\"\<Times\>\""}]}], "]"}], "&"}], 
        ")"}]}], ",", 
      RowBox[{"InterpretationFunction", "->", 
       RowBox[{"(", 
        RowBox[{"\"\<UniversalSet\>\"", "&"}], ")"}]}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CurrentValue", "[", 
     RowBox[{
      RowBox[{"EvaluationNotebook", "[", "]"}], ",", "InputAliases"}], "]"}], 
    "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<su\>\"", "->", "\"\<\[SquareUnion]\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<si\>\"", "->", "\"\<\[SquareIntersection]\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<sb\>\"", "->", "\"\<\[SquareSubset]\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<bs\>\"", "->", "\"\<\[Backslash]\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<es\>\"", "->", 
       RowBox[{"TemplateBox", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "\"\<EmptySet\>\"", ",", 
         RowBox[{"DisplayFunction", "->", 
          RowBox[{"(", 
           RowBox[{"\"\<\[EmptySet]\>\"", "&"}], ")"}]}], ",", 
         RowBox[{"InterpretationFunction", "->", 
          RowBox[{"(", 
           RowBox[{"\"\<EmptySet\>\"", "&"}], ")"}]}]}], "]"}]}], ",", 
      RowBox[{"\"\<us\>\"", "->", 
       RowBox[{"TemplateBox", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "\"\<UniversalSet\>\"", ",", 
         RowBox[{"DisplayFunction", "->", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"StyleBox", "[", 
             RowBox[{"\"\<\[DoubleStruckCapitalU]\>\"", ",", 
              RowBox[{"FontFamily", "->", "\"\<Times\>\""}]}], "]"}], "&"}], 
           ")"}]}], ",", 
         RowBox[{"InterpretationFunction", "->", 
          RowBox[{"(", 
           RowBox[{"\"\<UniversalSet\>\"", "&"}], ")"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ToBoolean", "[", "expr_", "]"}], ":=", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"expr", ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SquareUnion", "->", "Or"}], ",", "\[IndentingNewLine]", 
       RowBox[{"SquareIntersection", "->", "And"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"SquareSubset", "->", "Implies"}], ",", "\[IndentingNewLine]", 
       RowBox[{"OverBar", "->", "Not"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Backslash", "->", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"And", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"!", "#2"}]}], "]"}], "&"}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Equal", "->", "Equivalent"}], ",", "\[IndentingNewLine]", 
       RowBox[{"EmptySet", "->", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"UniversalSet", "->", "True"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"CirclePlus", "->", "Xor"}]}], "\[IndentingNewLine]", "}"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SetQ", "[", "EmptySet", "]"}], "=", "True"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SetQ", "[", "UniversalSet", "]"}], "=", "True"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SetQ", "[", "_Symbol", "]"}], "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetQ", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
     "Backslash", "|", "SquareUnion", "|", "SquareIntersection", "|", 
      "OverBar"}], ")"}], "[", "a__", "]"}], "]"}], ":=", 
  RowBox[{"AllTrue", "[", 
   RowBox[{
    RowBox[{"{", "a", "}"}], ",", "SetQ"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetQ", "[", "_", "]"}], "=", "False"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FromBoolean", "[", "expr_", "]"}], ":=", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"expr", ",", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Or", "->", "SquareUnion"}], ",", "\[IndentingNewLine]", 
       RowBox[{"And", "->", "SquareIntersection"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Not", "->", "OverBar"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Equivalent", "->", "Equal"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"Xor", "->", "CirclePlus"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"Implies", "->", "SquareSubset"}]}], "\[IndentingNewLine]", 
      "}"}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FromBoolean", "[", 
   RowBox[{"a_", "&&", 
    RowBox[{"!", "b_Symbol"}]}], "]"}], ":=", 
  RowBox[{"Backslash", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"FromBoolean", "[", 
   RowBox[{
    RowBox[{"!", "a_Symbol"}], "&&", "b_"}], "]"}], ":=", 
  RowBox[{"Backslash", "[", 
   RowBox[{"b", ",", "a"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"FromBoolean", "[", 
   RowBox[{"a_", "||", 
    RowBox[{"!", "b_Symbol"}]}], "]"}], ":=", 
  RowBox[{"SquareSubset", "[", 
   RowBox[{"b", ",", "a"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"FromBoolean", "[", 
   RowBox[{
    RowBox[{"!", "a_Symbol"}], "||", "b_"}], "]"}], ":=", 
  RowBox[{"SquareSubset", "[", 
   RowBox[{"a", ",", "b"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FromBoolean", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b_", "&&", 
       RowBox[{"!", "a_"}]}], ")"}], "||", 
     RowBox[{"(", 
      RowBox[{"a_", "&&", 
       RowBox[{"!", "b_"}]}], ")"}]}], "]"}], ":=", 
   RowBox[{"CirclePlus", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "SetSimplify", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"Method", "->", "Automatic"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Minimize", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SetSimplify", "[", 
    RowBox[{"set_", ",", 
     RowBox[{"cond_", ":", "True"}], ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "=", 
       RowBox[{"FromBoolean", "@", 
        RowBox[{"BooleanMinimize", "[", 
         RowBox[{
          RowBox[{"ToBoolean", "[", "set", "]"}], ",", 
          RowBox[{"ToBoolean", "[", "cond", "]"}], ",", 
          RowBox[{"Method", "->", 
           RowBox[{"OptionValue", "[", "Method", "]"}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SetQ", "[", "set", "]"}], ",", 
        RowBox[{"res", "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"False", "->", "EmptySet"}], ",", 
           RowBox[{"True", "->", "UniversalSet"}]}], "}"}]}], ",", "res"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"A", "\[Backslash]", "B"}], ")"}], "\[SquareUnion]", 
    RowBox[{"(", 
     RowBox[{"B", "\[Backslash]", "A"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Simplify", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSetSimplify", "[", "set_", "]"}], ":=", " ", 
  RowBox[{"FromBoolean", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"ToBoolean", "[", "set", "]"}], "]"}], "]"}]}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 InitializationCell->True,
 CellChangeTimes->{
  3.8418385355202503`*^9, 3.8418582515487595`*^9, {3.841858534526472*^9, 
   3.841858581698677*^9}, {3.8418586409551344`*^9, 3.8418586527192106`*^9}, 
   3.8418587200074587`*^9, 3.8425554215691214`*^9, {3.8425554559301805`*^9, 
   3.8425554827335014`*^9}, 3.8425559224970393`*^9, {3.842625017344182*^9, 
   3.8426250550261726`*^9}, {3.842625098096346*^9, 3.8426251031257153`*^9}, 
   3.8426251349165535`*^9, {3.84363925201515*^9, 3.843639330327199*^9}, {
   3.8436397704805617`*^9, 3.843639821507264*^9}, {3.843639866969611*^9, 
   3.843639867568424*^9}, {3.843639905909196*^9, 3.8436399084371433`*^9}, {
   3.843640107488821*^9, 3.843640176522815*^9}, {3.843641033660885*^9, 
   3.8436410396798353`*^9}, {3.843641082187637*^9, 3.8436411433492775`*^9}, {
   3.843641214311406*^9, 3.8436412306554117`*^9}, {3.84421160176101*^9, 
   3.8442116194126205`*^9}, {3.8442119554884443`*^9, 
   3.84421212360182*^9}},ExpressionUUID->"f2abc05f-485c-4e8c-9937-\
da7b7b239ae8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RationalQ", "[", "x_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "x", "]"}], "===", "Rational"}], "||", 
     RowBox[{"IntegerQ", "[", "x", "]"}]}], ")"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 InitializationCell->True,
 CellChangeTimes->{
  3.8418385355202503`*^9, 3.8418582515487595`*^9, {3.841858534526472*^9, 
   3.841858576644582*^9}, {3.841858640956132*^9, 3.84185865272021*^9}, 
   3.8418587200079546`*^9, {3.8419815026345634`*^9, 3.841981503283459*^9}, {
   3.841986910438764*^9, 3.8419869150095453`*^9}, {3.84253280944672*^9, 
   3.8425328191518307`*^9}, {3.84253458718397*^9, 3.8425345889335437`*^9}, 
   3.8435856061584415`*^9, {3.8435856402068415`*^9, 3.8435856405407963`*^9}, {
   3.8435857297884893`*^9, 3.8435857599337234`*^9}, 3.8435858443967566`*^9},
 CellLabel->"In[57]:=",ExpressionUUID->"c2a9311a-8ea3-4968-8d87-c50128bf09cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Needs", "[", "\"\<Combinatorica`\>\"", "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetPartitions", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"ResourceFunction", "[", "\"\<SetPartitions\>\"", "]"}], "[", "x",
     "]"}]}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 InitializationCell->True,
 CellChangeTimes->{
  3.8418385355202503`*^9, 3.8418582515487595`*^9, {3.841858534526472*^9, 
   3.841858576644582*^9}, {3.841858640956132*^9, 3.84185865272021*^9}, 
   3.8418587200079546`*^9, {3.8419815026345634`*^9, 3.841981503283459*^9}, {
   3.841986910438764*^9, 3.8419869150095453`*^9}, {3.84253280944672*^9, 
   3.8425328191518307`*^9}, {3.84253458718397*^9, 3.8425345889335437`*^9}, 
   3.8435856061584415`*^9, {3.8435856402068415`*^9, 3.8435856405407963`*^9}, {
   3.8435857297884893`*^9, 3.8435857599337234`*^9}, 3.8435858443967566`*^9},
 CellLabel->"In[58]:=",ExpressionUUID->"ef84b035-1fd1-4901-8d18-b3bc380cdb68"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "32876"}], "/", "how"}], "-", "to", "-", "show", 
     "-", "factorial", "-", "in", "-", "expanded", "-", "form", "-", "with", 
     "-", "variables"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FactorialExpand", "[", "expr_", "]"}], ":=", 
     RowBox[{
      RowBox[{"expr", "/.", " ", 
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{"n_", ",", "k_"}], "]"}], ":>", 
        RowBox[{
         RowBox[{
          RowBox[{"n", "!"}], "/", 
          RowBox[{"k", "!"}]}], "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "k"}], ")"}], "!"}]}]}]}], "/.", " ", 
      RowBox[{
       RowBox[{"Factorial", "[", "x_", "]"}], ":>", 
       RowBox[{"ProductSequence", "[", 
        RowBox[{"1", ",", "x"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{
    RowBox[{"ProductSequence", "/:", 
     RowBox[{
      RowBox[{"ProductSequence", "[", 
       RowBox[{"a_", ",", "b1_"}], "]"}], "/", 
      RowBox[{"ProductSequence", "[", 
       RowBox[{"a_", ",", "b2_"}], "]"}]}], ":=", 
     RowBox[{"ProductSequence", "[", 
      RowBox[{
       RowBox[{"b2", "+", "1"}], ",", "b1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeBoxes", "[", 
      RowBox[{
       RowBox[{"ProductSequence", "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], ",", "StandardForm"}], "]"}], "^:=", 
     RowBox[{
      RowBox[{
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"MakeBoxes", "[", 
           RowBox[{"#1", " ", "#2"}], "]"}], ",", "\"\<...\>\"", ",", 
          RowBox[{"MakeBoxes", "[", 
           RowBox[{"#3", " ", "#4"}], "]"}]}], "}"}], "]"}], "&"}], "[", 
      RowBox[{"a", ",", 
       RowBox[{"a", "+", "1"}], ",", 
       RowBox[{"b", "-", "1"}], ",", "b"}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.843607448139249*^9, {3.843608164979249*^9, 3.843608168104869*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"1f427265-a30c-4dc3-9d15-51729e52c627"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ShowSteps", "[", "exp_", "]"}], ":=", 
   RowBox[{"WolframAlpha", "[", 
    RowBox[{"ToString", "@", 
     RowBox[{"HoldForm", "@", 
      RowBox[{"InputForm", "@", "exp"}]}]}], 
    RowBox[{"(*", 
     RowBox[{",", 
      RowBox[{"PodStates", "->", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Input__Step-by-step solution\>\"", ",", 
         "\"\<Input__Show all steps\>\""}], "}"}]}]}], "*)"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"ShowSteps", ",", "HoldAll"}], "]"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 InitializationCell->True,
 CellChangeTimes->{
  3.8418385355202503`*^9, 3.8418582515487595`*^9, {3.841858534526472*^9, 
   3.841858576644582*^9}, {3.841858640956132*^9, 3.84185865272021*^9}, 
   3.8418587200079546`*^9, {3.8419815026345634`*^9, 3.841981503283459*^9}, {
   3.841986910438764*^9, 3.8419869150095453`*^9}, {3.84253280944672*^9, 
   3.8425328191518307`*^9}, {3.84253458718397*^9, 3.842534594476944*^9}, {
   3.8426412023904448`*^9, 3.842641287938862*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"ca179ea2-24ab-4e65-811d-db5a5681c229"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 3}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{
  Inherited, 5},ExpressionUUID->"a3b7bc80-39ed-4f7c-8b48-7f2e98e423ae"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FromBoolean", "[", 
  RowBox[{"A", "\[And]", 
   RowBox[{"!", "B"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8442114445503035`*^9, 3.844211476044449*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"92c72e42-c0b8-4dc5-9d8d-38dce0c854b3"],

Cell[BoxData[
 RowBox[{"A", "\[Backslash]", "B"}]], "Output",
 CellChangeTimes->{3.8442114763878813`*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"5c5c3e93-f173-4bcb-8fe1-32dbec06542c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetSimplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"A", "\[Backslash]", "B"}], ")"}], "\[SquareUnion]", 
   RowBox[{"(", 
    RowBox[{"B", "\[Backslash]", "A"}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8442115577933507`*^9, 3.8442116338894176`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"1f69e47c-6a83-4840-bb90-29e614238a37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "\[SquareIntersection]", 
   OverscriptBox["B", "_"]}], "\[SquareUnion]", 
  RowBox[{
   OverscriptBox["A", "_"], "\[SquareIntersection]", "B"}]}]], "Output",
 CellChangeTimes->{3.8442116344316015`*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"e8c44244-52d0-40fe-88cc-5b853a445160"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToBoolean", "[", 
  RowBox[{"A", "\[CirclePlus]", "B"}], "]"}]], "Input",
 CellChangeTimes->{{3.8442116880832176`*^9, 3.8442116963164587`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"f8384b12-a233-4e71-837e-0fe4d503ebc1"],

Cell[BoxData[
 RowBox[{"A", "\[Xor]", "B"}]], "Output",
 CellChangeTimes->{3.844211696491728*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"f9cc56bc-aa8e-42fa-ade1-badbbb92b013"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.844211706037174*^9, 3.8442117158833*^9}, 
   3.8442117532636824`*^9},ExpressionUUID->"626866ee-19ee-4e41-936b-\
48e7c23dc9ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"A", "\[Backslash]", "B"}], ")"}], "\[SquareUnion]", 
    RowBox[{"(", 
     RowBox[{"B", "\[Backslash]", "A"}], ")"}]}], ")"}], " ", "\\.", " ", 
  RowBox[{"(", 
   RowBox[{"A", "\[CirclePlus]", "B"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.844211847609825*^9, 3.8442118635041957`*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->"In[68]:=",ExpressionUUID->"829f24fa-445d-4112-9a90-02d7a21e9227"],

Cell[BoxData[
 RowBox[{"g", ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"A", "\[Backslash]", "B"}], ")"}], "\[SquareUnion]", 
   RowBox[{"(", 
    RowBox[{"B", "\[Backslash]", "A"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.844211867875668*^9, 3.844211869464512*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"eda6d377-21fe-41a8-bde0-197e15876873"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", " ", "/.", " ", 
  RowBox[{"{", 
   RowBox[{"(", 
    RowBox[{"A", "\[CirclePlus]", "B"}], ")"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.844211871675606*^9, 3.8442118965186386`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"ced94662-286c-4e63-80e1-e55c14bc3058"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"A\\\", \\\"\[CirclePlus]\\\", \
\\\"B\\\"}], \\\"}\\\"}]\\) is neither a list of replacement rules nor a \
valid dispatch table, and so cannot be used for replacing.\"", 2, 71, 6, 
   33890074281566255756, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.844211884275641*^9, 3.844211896769868*^9}},
 CellLabel->
  "During evaluation of \
In[71]:=",ExpressionUUID->"2f5abe74-6f4f-4b6e-85c0-74778ec48cea"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"A", "\[Backslash]", "B"}], "\[SquareUnion]", 
   RowBox[{"B", "\[Backslash]", "A"}]}], "/.", "\[VeryThinSpace]", 
  RowBox[{"{", 
   RowBox[{"A", "\[CirclePlus]", "B"}], "}"}]}]], "Output",
 CellChangeTimes->{{3.8442118843261395`*^9, 3.8442118967778673`*^9}},
 CellLabel->"Out[71]=",ExpressionUUID->"dd59322b-93fb-4257-9f30-97c42bcb6259"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["g"], "Input",
 CellChangeTimes->{3.8442118766599717`*^9},
 CellLabel->"In[69]:=",ExpressionUUID->"12ed97aa-019d-48eb-ac31-074a87dcb6e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "\[Backslash]", "B"}], "\[SquareUnion]", 
  RowBox[{"B", "\[Backslash]", "A"}]}]], "Output",
 CellChangeTimes->{3.844211876952699*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"2c2705ee-d7d8-489a-9024-5d71d0b4ed7c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["g"], "Input",
 CellChangeTimes->{3.8442119115293393`*^9},
 CellLabel->"In[72]:=",ExpressionUUID->"b8f10a72-12da-48ff-a7cb-688dbefefe02"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "\[Backslash]", "B"}], "\[SquareUnion]", 
  RowBox[{"B", "\[Backslash]", "A"}]}]], "Output",
 CellChangeTimes->{3.8442119117540536`*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"70d350c8-5dd9-4835-b637-e53062ba750f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Replace", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"A", "\[Backslash]", "B"}], ")"}], "\[SquareUnion]", 
    RowBox[{"(", 
     RowBox[{"B", "\[Backslash]", "A"}], ")"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"A", "\[Backslash]", "B"}], ")"}], "\[SquareUnion]", 
     RowBox[{"(", 
      RowBox[{"B", "\[Backslash]", "A"}], ")"}]}], "->", 
    RowBox[{"(", 
     RowBox[{"a", "\[CirclePlus]", "b"}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8442119172747097`*^9, 3.8442119424492965`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"b1af074a-b38d-4384-accc-4d581618d909"],

Cell[BoxData[
 RowBox[{"a", "\[CirclePlus]", "b"}]], "Output",
 CellChangeTimes->{{3.8442119368445435`*^9, 3.8442119427797284`*^9}},
 CellLabel->"Out[74]=",ExpressionUUID->"a5317931-5df1-48a9-a419-047e15088861"],

Cell[BoxData[
 RowBox[{
  RowBox[{"buf", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "\[Backslash]", "b"}], ")"}], "\[SquareUnion]", 
     RowBox[{"(", 
      RowBox[{"b", "\[Backslash]", "a"}], ")"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "\[Backslash]", "b"}], ")"}], "\[SquareUnion]", 
      RowBox[{"(", 
       RowBox[{"b", "\[Backslash]", "a"}], ")"}]}], "->", 
     RowBox[{"(", 
      RowBox[{"a", "\[CirclePlus]", "b"}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.844212059144019*^9, 3.844212073584676*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"3f04dfd3-d801-47ad-9b53-3bbc45a2debc"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8442120754459133`*^9, 
  3.844212078100396*^9}},ExpressionUUID->"290775fd-2301-47ef-82a4-\
f4b0f18f93b5"]
},
ScreenStyleEnvironment->"WorkingDark",
CellGrouping->Manual,
WindowSize->{834, 729},
WindowMargins->{{-1148, Automatic}, {-67, Automatic}},
TaggingRules->Association["TryRealOnly" -> False],
InputAliases->{
 "su" -> "\[SquareUnion]", "si" -> "\[SquareIntersection]", "sb" -> 
  "\[SquareSubset]", "bs" -> "\[Backslash]", "es" -> 
  TemplateBox[{}, "EmptySet", DisplayFunction -> ("\[EmptySet]"& ), 
    InterpretationFunction -> ("EmptySet"& )], "us" -> 
  TemplateBox[{}, "UniversalSet", 
    DisplayFunction -> (StyleBox[
     "\[DoubleStruckCapitalU]", FontFamily -> "Times"]& ), 
    InterpretationFunction -> ("UniversalSet"& )]},
Magnification:>1. Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8542740a-269b-4f24-8cbc-63d5e339ac7b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 700, 14, 219, "Text",ExpressionUUID->"e31d5a77-b1ca-47bb-8f44-a09bbd99dc93"],
Cell[1283, 38, 3377, 89, 266, "Input",ExpressionUUID->"394424fb-3331-447f-8d1b-0efbebb0e9c9",
 CellGroupingRules->{"GroupTogetherGrouping", 10001.},
 InitializationCell->True],
Cell[CellGroupData[{
Cell[4685, 131, 1381, 37, 106, "Input",ExpressionUUID->"6900b41d-071e-4396-98a9-de48135572ae",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 InitializationCell->True],
Cell[6069, 170, 442, 8, 45, "Input",ExpressionUUID->"5a3c3127-7de1-47eb-a4af-6817984596f0",
 CellGroupingRules->{"GroupTogetherGrouping", 10002.},
 InitializationCell->True],
Cell[CellGroupData[{
Cell[6536, 182, 9618, 246, 1366, "Input",ExpressionUUID->"f2abc05f-485c-4e8c-9937-da7b7b239ae8",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 InitializationCell->True],
Cell[CellGroupData[{
Cell[16179, 432, 973, 19, 45, "Input",ExpressionUUID->"c2a9311a-8ea3-4968-8d87-c50128bf09cd",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 InitializationCell->True],
Cell[17155, 453, 1023, 20, 66, "Input",ExpressionUUID->"ef84b035-1fd1-4901-8d18-b3bc380cdb68",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 InitializationCell->True],
Cell[18181, 475, 2326, 66, 206, "Input",ExpressionUUID->"1f427265-a30c-4dc3-9d15-51729e52c627",
 InitializationCell->True],
Cell[20510, 543, 1191, 27, 106, "Input",ExpressionUUID->"ca179ea2-24ab-4e65-811d-db5a5681c229",
 CellGroupingRules->{"GroupTogetherGrouping", 10003.},
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[21752, 576, 329, 10, 10, "Text",ExpressionUUID->"a3b7bc80-39ed-4f7c-8b48-7f2e98e423ae"],
Cell[CellGroupData[{
Cell[22106, 590, 258, 5, 29, "Input",ExpressionUUID->"92c72e42-c0b8-4dc5-9d8d-38dce0c854b3"],
Cell[22367, 597, 184, 3, 33, "Output",ExpressionUUID->"5c5c3e93-f173-4bcb-8fe1-32dbec06542c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22588, 605, 369, 8, 29, "Input",ExpressionUUID->"1f69e47c-6a83-4840-bb90-29e614238a37"],
Cell[22960, 615, 320, 7, 40, "Output",ExpressionUUID->"e8c44244-52d0-40fe-88cc-5b853a445160"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23317, 627, 246, 4, 29, "Input",ExpressionUUID->"f8384b12-a233-4e71-837e-0fe4d503ebc1"],
Cell[23566, 633, 176, 3, 33, "Output",ExpressionUUID->"f9cc56bc-aa8e-42fa-ade1-badbbb92b013"]
}, Open  ]],
Cell[23757, 639, 175, 3, 29, "Input",ExpressionUUID->"626866ee-19ee-4e41-936b-48e7c23dc9ed"],
Cell[23935, 644, 481, 12, 29, "Input",ExpressionUUID->"829f24fa-445d-4112-9a90-02d7a21e9227"],
Cell[24419, 658, 351, 8, 29, "Input",ExpressionUUID->"eda6d377-21fe-41a8-bde0-197e15876873"],
Cell[CellGroupData[{
Cell[24795, 670, 291, 6, 29, "Input",ExpressionUUID->"ced94662-286c-4e63-80e1-e55c14bc3058"],
Cell[25089, 678, 527, 11, 28, "Message",ExpressionUUID->"2f5abe74-6f4f-4b6e-85c0-74778ec48cea"],
Cell[25619, 691, 385, 8, 33, "Output",ExpressionUUID->"dd59322b-93fb-4257-9f30-97c42bcb6259"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26041, 704, 150, 2, 29, "Input",ExpressionUUID->"12ed97aa-019d-48eb-ac31-074a87dcb6e4"],
Cell[26194, 708, 252, 5, 33, "Output",ExpressionUUID->"2c2705ee-d7d8-489a-9024-5d71d0b4ed7c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26483, 718, 150, 2, 29, "Input",ExpressionUUID->"b8f10a72-12da-48ff-a7cb-688dbefefe02"],
Cell[26636, 722, 254, 5, 33, "Output",ExpressionUUID->"70d350c8-5dd9-4835-b637-e53062ba750f"]
}, Open  ]],
Cell[26905, 730, 647, 17, 29, "Input",ExpressionUUID->"b1af074a-b38d-4384-accc-4d581618d909"],
Cell[27555, 749, 211, 3, 33, "Output",ExpressionUUID->"a5317931-5df1-48a9-a419-047e15088861"],
Cell[27769, 754, 737, 20, 29, "Input",ExpressionUUID->"3f04dfd3-d801-47ad-9b53-3bbc45a2debc"],
Cell[28509, 776, 154, 3, 29, "Input",ExpressionUUID->"290775fd-2301-47ef-82a4-f4b0f18f93b5"]
}
]
*)

